@model Application.DTOs.CreateMessageViewModel
@inject Application.Contracts.ICurrentUserService CurrentUser

<auth-only>
    <form method="post"
          hx-post="/Account/Conversations/Messages/CreateMessage?handler=MessageOnConversation"
          hx-target="#message-form-wrapper"
          hx-swap="innerHTML"
          id="comment-form" asp-antiforgery="true">
            
        <input type="hidden" name="conversationId" value="@Model.ConversationId"/>

        <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

        <div class="d-flex align-items-start">
            <img src="@Url.Content("~/" + CurrentUser.AvatarPath)"
                 class="rounded-circle me-2 align-self-center" width="36" height="36" alt="Your avatar"/>
            <div class="flex-grow-1 d-flex align-items-center border rounded-3 px-3 py-2 bg-light">
                <textarea name="Content"
                              class="form-control border-0 bg-light me-2"
                              placeholder="Write your message..."
                              rows="1" minlength="2" maxlength="500"
                              style="resize: none; box-shadow: none; overflow: hidden"
                              required oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px';">@Model.Content</textarea>

                <button type="submit" class="btn btn-sm btn-primary px-3">
                    <i class="bi bi-send-fill"></i>
                </button>
            </div>
        </div>
    </form>
</auth-only>